Object.defineProperty(exports, "__esModule", {
    value: true
});

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var _ignore = require("ignore");

var _ignore2 = _interopRequireDefault(_ignore);

var _atom = require("atom");

var _jquery = require("jquery");

var _jquery2 = _interopRequireDefault(_jquery);

"use babel";

var oPackageConfig = undefined,
    fActivate = undefined,
    fDeactivate = undefined,
    _oDisposables = undefined,
    _oAtomIgnoreFileDisposables = undefined,
    _oMutationObserver = undefined,
    _bIsWindowsPlatform = document.body.classList.contains("platform-win32"),
    _oAtomIgnoreFiles = undefined,
    _fUpdate = undefined,
    _fApply = undefined,
    _fTreeViewHasMutated = undefined,
    _fProjectChangedPaths = undefined,
    _fGetCurrentState = undefined,
    _fAddAtomIgnoreFiles = undefined,
    _fNormalizePath = undefined,
    _fHandleIgnoreFile = undefined,
    _fUnhideParents = undefined;

exports.config = oPackageConfig = {
    "enabled": {
        "type": "boolean",
        "default": true
    },
    "ignoreFileName": {
        "type": "string",
        "default": ".atomignore"
    }
};

exports.activate = fActivate = function () {
    _oDisposables && _oDisposables.dispose();
    _oDisposables = new _atom.CompositeDisposable();

    _oDisposables.add(atom.commands.add("atom-workspace", {
        "tree-ignore:toggle": function treeIgnoreToggle() {
            _fApply(!atom.config.get("tree-ignore.enabled"));
        },
        "tree-ignore:enable": _fApply.bind(null, true),
        "tree-ignore:disable": _fApply.bind(null, false)
    }));

    _oDisposables.add(atom.commands.add(".platform-win32, .platform-linux, .platform-darwin", {
        "tree-view:toggle": _fUpdate.bind(null)
    }));

    _oMutationObserver = new MutationObserver(_fTreeViewHasMutated);

    atom.packages.onDidActivateInitialPackages(function () {
        _oDisposables.add(atom.project.onDidChangePaths(_fProjectChangedPaths));

        _fProjectChangedPaths();

        atom.config.observe("tree-ignore.enabled", function (bNewValue) {
            if (bNewValue !== atom.config.get("tree-ignore.enabled")) {
                _fApply(bNewValue);
            }
        });

        _fUpdate();
    });
};

exports.deactivate = fDeactivate = function () {
    _oDisposables && _oDisposables.dispose();
    _oAtomIgnoreFileDisposables && _oAtomIgnoreFileDisposables.dispose();
    _oMutationObserver.disconnect();
};

_fGetCurrentState = function () {
    return atom.config.get("tree-ignore.enabled");
};

_fApply = function (bValue) {
    atom.config.set("tree-ignore.enabled", bValue);
    _fUpdate();
};

_fUpdate = function () {
    var oIgnore = undefined,
        oIgnoredItems = {},
        sProjectRoot = "",
        bHandleProject = undefined,
        bState = _fGetCurrentState();

    if (bState && document.querySelector(".tree-view")) {
        _oMutationObserver.observe(document.querySelector(".tree-view"), {
            "childList": true,
            "subtree": true
        });
    } else {
        _oMutationObserver.disconnect();
    }

    (0, _jquery2["default"])(atom.views.getView(atom.workspace)).find(".tree-view li.entry .name").each(function () {
        var sPath = undefined,
            $this = undefined,
            bFiltered = false;

        if (sPath = ($this = (0, _jquery2["default"])(this)).data("path")) {
            var $parent = $this.parents("li.entry").first();

            sPath = _fNormalizePath(sPath);
            if ($parent.hasClass("directory")) {
                sPath += "/";
            }
            if ($parent.hasClass("project-root")) {
                sProjectRoot = sPath;
                oIgnore = _fHandleIgnoreFile(sProjectRoot);
                bHandleProject = oIgnore != null;
            }
            if (oIgnore != null) {
                sPath = sPath.substring(sProjectRoot.length);
                bFiltered = oIgnore.filter([sPath]).length === 0;
                if (bFiltered) {
                    if (sPath.endsWith("/")) {
                        oIgnoredItems[sPath] = $parent;
                    }
                } else {
                    _fUnhideParents(oIgnoredItems, sPath);
                }
            }
            $parent.toggleClass("tree-ignore-element", bState && bHandleProject && bFiltered);
        }
    });
};

_fTreeViewHasMutated = function () {
    _fUpdate();
};

_fProjectChangedPaths = function () {
    _fAddAtomIgnoreFiles();
    _fUpdate();
};

_fAddAtomIgnoreFiles = function () {
    var sIgnoreFileName = atom.config.get("tree-ignore.ignoreFileName");

    _oAtomIgnoreFileDisposables && _oAtomIgnoreFileDisposables.dispose();
    _oAtomIgnoreFileDisposables = new _atom.CompositeDisposable();
    _oAtomIgnoreFiles = {};

    atom.project.getDirectories().forEach(function (oDirectory) {
        var oIgnoreFile = oDirectory.getFile(sIgnoreFileName);

        _oAtomIgnoreFiles[_fNormalizePath(oDirectory.getPath() + "/")] = oIgnoreFile;
        _oAtomIgnoreFileDisposables.add(oIgnoreFile.onDidChange(_fUpdate));
    });
};

_fNormalizePath = function (sPath) {
    if (_bIsWindowsPlatform) {
        return sPath.replace(/\\/g, "/");
    }
    return sPath;
};

_fHandleIgnoreFile = function (sPath) {
    var sIgnoreFile = _oAtomIgnoreFiles && _oAtomIgnoreFiles[sPath] ? _oAtomIgnoreFiles[sPath] : null;

    if (sIgnoreFile == null) {
        // New root / project path, look if it has an ignore file
        return null; // Don't handle this project
    }
    if (!sIgnoreFile.existsSync()) {
        return null; // Removed, unhide everything
    }

    return (0, _ignore2["default"])().addIgnoreFile(sIgnoreFile.getPath());
};

_fUnhideParents = function (oIgnoredItems, sPath) {
    var getParent = function getParent(sChildPath) {
        if (sChildPath.endsWith("/")) {
            return sChildPath.replace(/[^\/]*\/$/, "");
        }
        return sChildPath.replace(/\/.*?$/, "/");
    };
    var sParent = sPath,
        oItem = undefined;

    while (sParent.includes("/")) {
        sParent = getParent(sParent);
        oItem = oIgnoredItems[sParent];
        if (oItem != null) {
            oItem.removeClass("tree-ignore-element");
        }
    }
};

exports.config = oPackageConfig;
exports.activate = fActivate;
exports.deactivate = fDeactivate;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9nYWVsZW4vLmF0b20vcGFja2FnZXMvdHJlZS1pZ25vcmUvbGliL3RyZWUtaWdub3JlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztzQkFFbUIsUUFBUTs7OztvQkFDUyxNQUFNOztzQkFDNUIsUUFBUTs7OztBQUp0QixXQUFXLENBQUM7O0FBTVosSUFBSSxjQUFjLFlBQUE7SUFDZCxTQUFTLFlBQUE7SUFBRSxXQUFXLFlBQUE7SUFDdEIsYUFBYSxZQUFBO0lBQUUsMkJBQTJCLFlBQUE7SUFDMUMsa0JBQWtCLFlBQUE7SUFDbEIsbUJBQW1CLEdBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFFLGdCQUFnQixDQUFFO0lBQzFFLGlCQUFpQixZQUFBO0lBQ2pCLFFBQVEsWUFBQTtJQUFFLE9BQU8sWUFBQTtJQUFFLG9CQUFvQixZQUFBO0lBQUUscUJBQXFCLFlBQUE7SUFBRSxpQkFBaUIsWUFBQTtJQUNqRixvQkFBb0IsWUFBQTtJQUFFLGVBQWUsWUFBQTtJQUFFLGtCQUFrQixZQUFBO0lBQUUsZUFBZSxZQUFBLENBQUM7O0FBRS9FLFFBOEtzQixNQUFNLEdBOUs1QixjQUFjLEdBQUc7QUFDYixhQUFTLEVBQUU7QUFDUCxjQUFNLEVBQUUsU0FBUztBQUNqQixpQkFBUyxFQUFFLElBQUk7S0FDbEI7QUFDRCxvQkFBZ0IsRUFBRTtBQUNkLGNBQU0sRUFBRSxRQUFRO0FBQ2hCLGlCQUFTLEVBQUUsYUFBYTtLQUMzQjtDQUNKLENBQUM7O0FBRUYsUUFvS2lCLFFBQVEsR0FwS3pCLFNBQVMsR0FBRyxZQUFXO0FBQ25CLGlCQUFhLElBQUksYUFBYSxDQUFDLE9BQU8sRUFBRSxDQUFDO0FBQ3pDLGlCQUFhLEdBQUcsK0JBQXlCLENBQUM7O0FBRTFDLGlCQUFhLENBQUMsR0FBRyxDQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFFLGdCQUFnQixFQUFFO0FBQ3BELDRCQUFvQixFQUFFLDRCQUFNO0FBQ3hC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QUc7QUFDN0IsZUFBTyxJQUFJLENBQUM7S0FDZjs7QUFFRCxXQUFPLDBCQUFRLENBQUMsYUFBYSxDQUFFLFdBQVcsQ0FBQyxPQUFPLEVBQUUsQ0FBRSxDQUFDO0NBQzFELENBQUM7O0FBRUYsZUFBZSxHQUFHLFVBQVUsYUFBYSxFQUFFLEtBQUssRUFBRztBQUMvQyxRQUFNLFNBQVMsR0FBRyxTQUFaLFNBQVMsQ0FBYSxVQUFVLEVBQUc7QUFDckMsWUFBSyxVQUFVLENBQUMsUUFBUSxDQUFFLEdBQUcsQ0FBRSxFQUFHO0FBQzlCLG1CQUFPLFVBQVUsQ0FBQyxPQUFPLENBQUUsV0FBVyxFQUFFLEVBQUUsQ0FBRSxDQUFDO1NBQ2hEO0FBQ0QsZUFBTyxVQUFVLENBQUMsT0FBTyxDQUFFLFFBQVEsRUFBRSxHQUFHLENBQUUsQ0FBQztLQUM5QyxDQUFDO0FBQ0YsUUFBSSxPQUFPLEdBQUcsS0FBSztRQUFFLEtBQUssWUFBQSxDQUFDOztBQUUzQixXQUFRLE9BQU8sQ0FBQyxRQUFRLENBQUUsR0FBRyxDQUFFLEVBQUc7QUFDOUIsZUFBTyxHQUFHLFNBQVMsQ0FBRSxPQUFPLENBQUUsQ0FBQztBQUMvQixhQUFLLEdBQUcsYUFBYSxDQUFFLE9BQU8sQ0FBRSxDQUFDO0FBQ2pDLFlBQUssS0FBSyxJQUFJLElBQUksRUFBRztBQUNqQixpQkFBSyxDQUFDLFdBQVcsQ0FBRSxxQkFBcUIsQ0FBRSxDQUFDO1NBQzlDO0tBQ0o7Q0FDSixDQUFDOztRQUdvQixNQUFNLEdBQXhCLGNBQWM7UUFDRCxRQUFRLEdBQXJCLFNBQVM7UUFDTSxVQUFVLEdBQXpCLFdBQVciLCJmaWxlIjoiL1VzZXJzL2dhZWxlbi8uYXRvbS9wYWNrYWdlcy90cmVlLWlnbm9yZS9saWIvdHJlZS1pZ25vcmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBiYWJlbFwiO1xuXG5pbXBvcnQgaWdub3JlIGZyb20gXCJpZ25vcmVcIjtcbmltcG9ydCB7IENvbXBvc2l0ZURpc3Bvc2FibGUgfSBmcm9tIFwiYXRvbVwiO1xuaW1wb3J0ICQgZnJvbSBcImpxdWVyeVwiO1xuXG5sZXQgb1BhY2thZ2VDb25maWcsXG4gICAgZkFjdGl2YXRlLCBmRGVhY3RpdmF0ZSxcbiAgICBfb0Rpc3Bvc2FibGVzLCBfb0F0b21JZ25vcmVGaWxlRGlzcG9zYWJsZXMsXG4gICAgX29NdXRhdGlvbk9ic2VydmVyLFxuICAgIF9iSXNXaW5kb3dzUGxhdGZvcm0gPSBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucyggXCJwbGF0Zm9ybS13aW4zMlwiICksXG4gICAgX29BdG9tSWdub3JlRmlsZXMsXG4gICAgX2ZVcGRhdGUsIF9mQXBwbHksIF9mVHJlZVZpZXdIYXNNdXRhdGVkLCBfZlByb2plY3RDaGFuZ2VkUGF0aHMsIF9mR2V0Q3VycmVudFN0YXRlLFxuICAgIF9mQWRkQXRvbUlnbm9yZUZpbGVzLCBfZk5vcm1hbGl6ZVBhdGgsIF9mSGFuZGxlSWdub3JlRmlsZSwgX2ZVbmhpZGVQYXJlbnRzO1xuXG5vUGFja2FnZUNvbmZpZyA9IHtcbiAgICBcImVuYWJsZWRcIjoge1xuICAgICAgICBcInR5cGVcIjogXCJib29sZWFuXCIsXG4gICAgICAgIFwiZGVmYXVsdFwiOiB0cnVlXG4gICAgfSxcbiAgICBcImlnbm9yZUZpbGVOYW1lXCI6IHtcbiAgICAgICAgXCJ0eXBlXCI6IFwic3RyaW5nXCIsXG4gICAgICAgIFwiZGVmYXVsdFwiOiBcIi5hdG9taWdub3JlXCJcbiAgICB9XG59O1xuXG5mQWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcbiAgICBfb0Rpc3Bvc2FibGVzICYmIF9vRGlzcG9zYWJsZXMuZGlzcG9zZSgpO1xuICAgIF9vRGlzcG9zYWJsZXMgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuXG4gICAgX29EaXNwb3NhYmxlcy5hZGQoIGF0b20uY29tbWFuZHMuYWRkKCBcImF0b20td29ya3NwYWNlXCIsIHtcbiAgICAgICAgXCJ0cmVlLWlnbm9yZTp0b2dnbGVcIjogKCkgPT4ge1xuICAgICAgICAgICAgX2ZBcHBseSggIWF0b20uY29uZmlnLmdldCggXCJ0cmVlLWlnbm9yZS5lbmFibGVkXCIgKSApO1xuICAgICAgICB9LFxuICAgICAgICBcInRyZWUtaWdub3JlOmVuYWJsZVwiOiBfZkFwcGx5LmJpbmQoIG51bGwsIHRydWUgKSxcbiAgICAgICAgXCJ0cmVlLWlnbm9yZTpkaXNhYmxlXCI6IF9mQXBwbHkuYmluZCggbnVsbCwgZmFsc2UgKVxuICAgIH0gKSApO1xuXG4gICAgX29EaXNwb3NhYmxlcy5hZGQoIGF0b20uY29tbWFuZHMuYWRkKCBcIi5wbGF0Zm9ybS13aW4zMiwgLnBsYXRmb3JtLWxpbnV4LCAucGxhdGZvcm0tZGFyd2luXCIsIHtcbiAgICAgICAgXCJ0cmVlLXZpZXc6dG9nZ2xlXCI6IF9mVXBkYXRlLmJpbmQoIG51bGwgKVxuICAgIH0gKSApO1xuXG4gICAgX29NdXRhdGlvbk9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoIF9mVHJlZVZpZXdIYXNNdXRhdGVkICk7XG5cbiAgICBhdG9tLnBhY2thZ2VzLm9uRGlkQWN0aXZhdGVJbml0aWFsUGFja2FnZXMoICgpID0+IHtcbiAgICAgICAgX29EaXNwb3NhYmxlcy5hZGQoIGF0b20ucHJvamVjdC5vbkRpZENoYW5nZVBhdGhzKCBfZlByb2plY3RDaGFuZ2VkUGF0aHMgKSApO1xuXG4gICAgICAgIF9mUHJvamVjdENoYW5nZWRQYXRocygpO1xuXG4gICAgICAgIGF0b20uY29uZmlnLm9ic2VydmUoIFwidHJlZS1pZ25vcmUuZW5hYmxlZFwiLCAoIGJOZXdWYWx1ZSApID0+IHtcbiAgICAgICAgICAgIGlmICggYk5ld1ZhbHVlICE9PSBhdG9tLmNvbmZpZy5nZXQoIFwidHJlZS1pZ25vcmUuZW5hYmxlZFwiICkgKSB7XG4gICAgICAgICAgICAgICAgX2ZBcHBseSggYk5ld1ZhbHVlICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gKTtcblxuICAgICAgICBfZlVwZGF0ZSgpO1xuICAgIH0gKTtcbn07XG5cbmZEZWFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgX29EaXNwb3NhYmxlcyAmJiBfb0Rpc3Bvc2FibGVzLmRpc3Bvc2UoKTtcbiAgICBfb0F0b21JZ25vcmVGaWxlRGlzcG9zYWJsZXMgJiYgX29BdG9tSWdub3JlRmlsZURpc3Bvc2FibGVzLmRpc3Bvc2UoKTtcbiAgICBfb011dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xufTtcblxuX2ZHZXRDdXJyZW50U3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gYXRvbS5jb25maWcuZ2V0KCBcInRyZWUtaWdub3JlLmVuYWJsZWRcIiApO1xufTtcblxuX2ZBcHBseSA9IGZ1bmN0aW9uKCBiVmFsdWUgKSB7XG4gICAgYXRvbS5jb25maWcuc2V0KCBcInRyZWUtaWdub3JlLmVuYWJsZWRcIiwgYlZhbHVlICk7XG4gICAgX2ZVcGRhdGUoKTtcbn07XG5cbl9mVXBkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgbGV0IG9JZ25vcmUsXG4gICAgICAgIG9JZ25vcmVkSXRlbXMgPSB7fSxcbiAgICAgICAgc1Byb2plY3RSb290ID0gXCJcIixcbiAgICAgICAgYkhhbmRsZVByb2plY3QsXG4gICAgICAgIGJTdGF0ZSA9IF9mR2V0Q3VycmVudFN0YXRlKCk7XG5cbiAgICBpZiAoIGJTdGF0ZSAmJiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBcIi50cmVlLXZpZXdcIiApICkge1xuICAgICAgICBfb011dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZSggZG9jdW1lbnQucXVlcnlTZWxlY3RvciggXCIudHJlZS12aWV3XCIgKSwge1xuICAgICAgICAgICAgXCJjaGlsZExpc3RcIjogdHJ1ZSxcbiAgICAgICAgICAgIFwic3VidHJlZVwiOiB0cnVlXG4gICAgICAgIH0gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBfb011dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgIH1cblxuICAgICQoIGF0b20udmlld3MuZ2V0VmlldyggYXRvbS53b3Jrc3BhY2UgKSApXG4gICAgICAgIC5maW5kKCBcIi50cmVlLXZpZXcgbGkuZW50cnkgLm5hbWVcIiApLmVhY2goIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbGV0IHNQYXRoLFxuICAgICAgICAgICAgICAgICR0aGlzLFxuICAgICAgICAgICAgICAgIGJGaWx0ZXJlZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICBpZiAoIHNQYXRoID0gKCAkdGhpcyA9ICQoIHRoaXMgKSApLmRhdGEoIFwicGF0aFwiICkgKSB7XG4gICAgICAgICAgICAgICAgbGV0ICRwYXJlbnQgPSAkdGhpcy5wYXJlbnRzKCBcImxpLmVudHJ5XCIgKS5maXJzdCgpO1xuXG4gICAgICAgICAgICAgICAgc1BhdGggPSBfZk5vcm1hbGl6ZVBhdGgoIHNQYXRoICk7XG4gICAgICAgICAgICAgICAgaWYgKCAkcGFyZW50Lmhhc0NsYXNzKCBcImRpcmVjdG9yeVwiICkgKSB7XG4gICAgICAgICAgICAgICAgICAgIHNQYXRoICs9IFwiL1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoICRwYXJlbnQuaGFzQ2xhc3MoIFwicHJvamVjdC1yb290XCIgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgc1Byb2plY3RSb290ID0gc1BhdGg7XG4gICAgICAgICAgICAgICAgICAgIG9JZ25vcmUgPSBfZkhhbmRsZUlnbm9yZUZpbGUoIHNQcm9qZWN0Um9vdCApO1xuICAgICAgICAgICAgICAgICAgICBiSGFuZGxlUHJvamVjdCA9IG9JZ25vcmUgIT0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCBvSWdub3JlICE9IG51bGwgKSB7XG4gICAgICAgICAgICAgICAgICAgIHNQYXRoID0gc1BhdGguc3Vic3RyaW5nKCBzUHJvamVjdFJvb3QubGVuZ3RoICk7XG4gICAgICAgICAgICAgICAgICAgIGJGaWx0ZXJlZCA9IG9JZ25vcmUuZmlsdGVyKCBbIHNQYXRoIF0gKS5sZW5ndGggPT09IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmICggYkZpbHRlcmVkICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBzUGF0aC5lbmRzV2l0aCggXCIvXCIgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvSWdub3JlZEl0ZW1zWyBzUGF0aCBdID0gJHBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9mVW5oaWRlUGFyZW50cyggb0lnbm9yZWRJdGVtcywgc1BhdGggKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkcGFyZW50LnRvZ2dsZUNsYXNzKCBcInRyZWUtaWdub3JlLWVsZW1lbnRcIiwgYlN0YXRlICYmIGJIYW5kbGVQcm9qZWN0ICYmIGJGaWx0ZXJlZCApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ICk7XG59O1xuXG5fZlRyZWVWaWV3SGFzTXV0YXRlZCA9IGZ1bmN0aW9uKCkge1xuICAgIF9mVXBkYXRlKCk7XG59O1xuXG5fZlByb2plY3RDaGFuZ2VkUGF0aHMgPSBmdW5jdGlvbigpIHtcbiAgICBfZkFkZEF0b21JZ25vcmVGaWxlcygpO1xuICAgIF9mVXBkYXRlKCk7XG59O1xuXG5fZkFkZEF0b21JZ25vcmVGaWxlcyA9IGZ1bmN0aW9uKCkge1xuICAgIGxldCBzSWdub3JlRmlsZU5hbWUgPSBhdG9tLmNvbmZpZy5nZXQoIFwidHJlZS1pZ25vcmUuaWdub3JlRmlsZU5hbWVcIiApO1xuXG4gICAgX29BdG9tSWdub3JlRmlsZURpc3Bvc2FibGVzICYmIF9vQXRvbUlnbm9yZUZpbGVEaXNwb3NhYmxlcy5kaXNwb3NlKCk7XG4gICAgX29BdG9tSWdub3JlRmlsZURpc3Bvc2FibGVzID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcbiAgICBfb0F0b21JZ25vcmVGaWxlcyA9IHt9O1xuXG4gICAgYXRvbS5wcm9qZWN0LmdldERpcmVjdG9yaWVzKCkuZm9yRWFjaCggKCBvRGlyZWN0b3J5ICkgPT4ge1xuICAgICAgICBsZXQgb0lnbm9yZUZpbGUgPSBvRGlyZWN0b3J5LmdldEZpbGUoIHNJZ25vcmVGaWxlTmFtZSApO1xuXG4gICAgICAgIF9vQXRvbUlnbm9yZUZpbGVzWyBfZk5vcm1hbGl6ZVBhdGgoIGAkeyBvRGlyZWN0b3J5LmdldFBhdGgoKSB9L2AgKSBdID0gb0lnbm9yZUZpbGU7XG4gICAgICAgIF9vQXRvbUlnbm9yZUZpbGVEaXNwb3NhYmxlcy5hZGQoIG9JZ25vcmVGaWxlLm9uRGlkQ2hhbmdlKCBfZlVwZGF0ZSApICk7XG4gICAgfSApO1xufTtcblxuX2ZOb3JtYWxpemVQYXRoID0gZnVuY3Rpb24oIHNQYXRoICkge1xuICAgIGlmICggX2JJc1dpbmRvd3NQbGF0Zm9ybSApIHtcbiAgICAgICAgcmV0dXJuIHNQYXRoLnJlcGxhY2UoIC9cXFxcL2csIFwiL1wiICk7XG4gICAgfVxuICAgIHJldHVybiBzUGF0aDtcbn07XG5cbl9mSGFuZGxlSWdub3JlRmlsZSA9IGZ1bmN0aW9uKCBzUGF0aCApIHtcbiAgICBsZXQgc0lnbm9yZUZpbGUgPSBfb0F0b21JZ25vcmVGaWxlcyAmJiBfb0F0b21JZ25vcmVGaWxlc1sgc1BhdGggXSA/XG4gICAgICAgIF9vQXRvbUlnbm9yZUZpbGVzWyBzUGF0aCBdIDogbnVsbDtcblxuICAgIGlmICggc0lnbm9yZUZpbGUgPT0gbnVsbCApIHtcbiAgICAgICAgLy8gTmV3IHJvb3QgLyBwcm9qZWN0IHBhdGgsIGxvb2sgaWYgaXQgaGFzIGFuIGlnbm9yZSBmaWxlXG4gICAgICAgIHJldHVybiBudWxsOyAvLyBEb24ndCBoYW5kbGUgdGhpcyBwcm9qZWN0XG4gICAgfVxuICAgIGlmICggIXNJZ25vcmVGaWxlLmV4aXN0c1N5bmMoKSApIHtcbiAgICAgICAgcmV0dXJuIG51bGw7IC8vIFJlbW92ZWQsIHVuaGlkZSBldmVyeXRoaW5nXG4gICAgfVxuXG4gICAgcmV0dXJuIGlnbm9yZSgpLmFkZElnbm9yZUZpbGUoIHNJZ25vcmVGaWxlLmdldFBhdGgoKSApO1xufTtcblxuX2ZVbmhpZGVQYXJlbnRzID0gZnVuY3Rpb24oIG9JZ25vcmVkSXRlbXMsIHNQYXRoICkge1xuICAgIGNvbnN0IGdldFBhcmVudCA9IGZ1bmN0aW9uKCBzQ2hpbGRQYXRoICkge1xuICAgICAgICBpZiAoIHNDaGlsZFBhdGguZW5kc1dpdGgoIFwiL1wiICkgKSB7XG4gICAgICAgICAgICByZXR1cm4gc0NoaWxkUGF0aC5yZXBsYWNlKCAvW15cXC9dKlxcLyQvLCBcIlwiICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNDaGlsZFBhdGgucmVwbGFjZSggL1xcLy4qPyQvLCBcIi9cIiApO1xuICAgIH07XG4gICAgbGV0IHNQYXJlbnQgPSBzUGF0aCwgb0l0ZW07XG5cbiAgICB3aGlsZSAoIHNQYXJlbnQuaW5jbHVkZXMoIFwiL1wiICkgKSB7XG4gICAgICAgIHNQYXJlbnQgPSBnZXRQYXJlbnQoIHNQYXJlbnQgKTtcbiAgICAgICAgb0l0ZW0gPSBvSWdub3JlZEl0ZW1zWyBzUGFyZW50IF07XG4gICAgICAgIGlmICggb0l0ZW0gIT0gbnVsbCApIHtcbiAgICAgICAgICAgIG9JdGVtLnJlbW92ZUNsYXNzKCBcInRyZWUtaWdub3JlLWVsZW1lbnRcIiApO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuZXhwb3J0IHtcbiAgICBvUGFja2FnZUNvbmZpZyBhcyBjb25maWcsXG4gICAgZkFjdGl2YXRlIGFzIGFjdGl2YXRlLFxuICAgIGZEZWFjdGl2YXRlIGFzIGRlYWN0aXZhdGVcbn07XG4iXX0=
//# sourceURL=/Users/gaelen/.atom/packages/tree-ignore/lib/tree-ignore.js
